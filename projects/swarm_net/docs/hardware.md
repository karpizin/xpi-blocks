# Руководство по выбору оборудования для Meshtastic

В этом документе собраны рекомендации по подбору аппаратного обеспечения для интеграции LoRa Mesh в робототехнические системы XPI, с особым акцентом на роевые системы и автономные ретрансляторы.

---

## 1. Сценарии интеграции

### 1.1 Бортовой компьютер (Raspberry Pi / Jetson)
Если в роботе есть мощный хост-процессор, LoRa-модуль используется как периферийный модем.

*   **Рекомендуемое решение:** **RAK Wireless WisBlock (RAK4631)**.
    *   **Преимущества:** Чип nRF52840 потребляет в 3-5 раз меньше энергии, чем ESP32. Он практически не создает радиопомех для GPS-приемников дрона.
    *   **Интерфейс:** USB (через базовую плату RAK5005-O) или UART (прямое подключение к GPIO).
*   **Альтернатива (HAT):** **Waveshare SX1262 LoRa HAT**.
    *   **Преимущества:** Компактная установка "бутербродом".
    *   **Сложность:** Требует специфической конфигурации прошивки для работы именно в режиме Meshtastic Node под Linux.

### 1.2 Автономный узел (Микро-дроны / Маяки)
Когда вес и размер критичны, а вычислительной мощности полетного контроллера (MCU) достаточно.

*   **Рекомендуемое решение:** **Heltec LoRa Stick (V3)**.
    *   Размером с USB-флешку, минимальный вес.
*   **LilyGO T-Beam S3 Supreme:**
    *   Встроенный GPS высокой точности и контроллер заряда батареи.

---

## 2. Специальное решение: Сбрасываемый ретранслятор (Drop-and-Forget)

Сценарий: Дрон доставляет ретранслятор в труднодоступную точку (крыша здания, вершина холма), сбрасывает его, и узел начинает работать автономно для расширения зоны покрытия роя.

### 2.1 Технические требования
1.  **Энергоэффективность:** Должен работать неделями без подзарядки.
2.  **Ударопрочность:** Должен выживать при падении с высоты 2-5 метров.
3.  **Самодостаточность:** Автоматический запуск и поиск соседей.

### 2.2 Рекомендуемый набор (BOM)
*   **Контроллер:** **RAK4631 (WisBlock Core)**. Использование nRF52 — единственный способ добиться реальной автономности.
*   **Питание:**
    *   Аккумулятор: Li-Po или Li-ion 18650 (3000-3500 mAh).
    *   Солнечная панель: Небольшая панель на 5V/100mA, закрепленная на верхней грани корпуса. RAK WisBlock имеет встроенный контроллер заряда для солнечных панелей.
*   **Антенна:** Короткая гибкая антенна 868 МГц ("Stubby"), чтобы не сломаться при ударе о землю.

### 2.3 Конструктивные особенности
*   **Амортизация:** Корпус должен быть напечатан из TPU (гибкий пластик) или иметь резиновые демпферы.
*   **Ориентация:** Утяжеленное дно (аккумулятор снизу), чтобы модуль приземлялся антенной вверх.
*   **Герметичность:** IP65/67 для защиты от дождя и росы.

### 2.4 Программная логика для сброса
*   **Режим "Router" или "Repeater":** В настройках Meshtastic узел должен быть помечен как стационарный ретранслятор (это экономит эфирное время, так как он не шлет пакеты о своем перемещении).
*   **Deep Sleep:** Настройка перехода в сон при низком заряде батареи и пробуждение при появлении солнца.

---

## 3. Антенное хозяйство

Эффективность роя на 70% зависит от антенн, а не от мощности передатчика.

*   **Для летающих узлов:** Дипольные антенны на гибком кабеле (U.FL -> SMA). Важно выносить антенну подальше от регуляторов моторов и видеопередатчиков.
*   **Для наземных станций:** Коллинеарные антенны (Omni-directional) с усилением 5.8 dBi. Установка на мачте дает прирост дальности в 2-3 раза.

---

## 4. Сводная таблица выбора

| Задача | Рекомендуемое железо | Интерфейс | Приоритет |
| :--- | :--- | :--- | :--- |
| **Центр управления (RPi)** | RAK4631 (WisBlock) | USB/UART | Энергоэффективность |
| **Дрон роя** | Heltec V3 Stick | UART | Вес / Габариты |
| **Сбрасываемый ретранслятор** | RAK4631 + Solar | Autonomous | Автономность |
| **Мобильный терминал** | LilyGO T-Echo | Bluetooth/BLE | E-Ink экран |
